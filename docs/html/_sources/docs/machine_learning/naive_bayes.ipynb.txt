{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%run loadmlfuncs.py"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Naive Bayes\n",
    "\n",
    "Naive Bayes models are a group of extremely fast and simple classification algorithms that are often suitable for very high-dimensional datasets. Because they are so fast and have so few tunable parameters, they end up being very useful as a quick-and-dirty baseline for a classification problem. This section will focus on an intuitive explanation of how naive Bayes classifiers work, followed by a couple examples of them in action on some datasets."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Bayesian Classification\n",
    "\n",
    "Naive Bayes classifiers are built on Bayesian classification methods.\n",
    "These rely on Bayes's theorem, which is an equation describing the relationship of conditional probabilities of statistical quantities.\n",
    "In Bayesian classification, we're interested in finding the probability of a label given some observed features, which we can write as $P(L~|~{\\rm features})$.\n",
    "Bayes's theorem tells us how to express this in terms of quantities we can compute more directly:\n",
    "\n",
    "$$\n",
    "P(L~|~{\\rm features}) = \\frac{P({\\rm features}~|~L)P(L)}{P({\\rm features})}\n",
    "$$\n",
    "\n",
    "If we are trying to decide between two labels—let's call them $L_1$ and $L_2$—then one way to make this decision is to compute the ratio of the posterior probabilities for each label:\n",
    "\n",
    "$$\n",
    "\\frac{P(L_1~|~{\\rm features})}{P(L_2~|~{\\rm features})} = \\frac{P({\\rm features}~|~L_1)}{P({\\rm features}~|~L_2)}\\frac{P(L_1)}{P(L_2)}\n",
    "$$\n",
    "\n",
    "All we need now is some model by which we can compute $P({\\rm features}~|~L_i)$ for each label.\n",
    "Such a model is called a *generative model* because it specifies the hypothetical random process that generates the data.\n",
    "Specifying this generative model for each label is the main piece of the training of such a Bayesian classifier.\n",
    "The general version of such a training step is a very difficult task, but we can make it simpler through the use of some simplifying assumptions about the form of this model.\n",
    "\n",
    "This is where the \"naive\" in \"naive Bayes\" comes in: if we make very naive assumptions about the generative model for each label, we can find a rough approximation of the generative model for each class, and then proceed with the Bayesian classification.\n",
    "Different types of naive Bayes classifiers rest on different naive assumptions about the data, and we will examine a few of these in the following sections."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Bernoulli Naive Bayes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There are 856 people who have either tried or not tried a company's new frozen lasagna product. The data includes the categorical dependent variable `tried` and several other explanatory variables."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>weight</th>\n",
       "      <th>income</th>\n",
       "      <th>car_value</th>\n",
       "      <th>debt</th>\n",
       "      <th>mall_trips</th>\n",
       "      <th>gender</th>\n",
       "      <th>alone</th>\n",
       "      <th>dwell</th>\n",
       "      <th>pay_type</th>\n",
       "      <th>nbhd</th>\n",
       "      <th>tried</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>person</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>48</td>\n",
       "      <td>175</td>\n",
       "      <td>65500</td>\n",
       "      <td>2190</td>\n",
       "      <td>3510</td>\n",
       "      <td>7</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Home</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>East</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>33</td>\n",
       "      <td>202</td>\n",
       "      <td>29100</td>\n",
       "      <td>2110</td>\n",
       "      <td>740</td>\n",
       "      <td>4</td>\n",
       "      <td>Female</td>\n",
       "      <td>No</td>\n",
       "      <td>Condo</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>East</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>51</td>\n",
       "      <td>188</td>\n",
       "      <td>32200</td>\n",
       "      <td>5140</td>\n",
       "      <td>910</td>\n",
       "      <td>1</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Condo</td>\n",
       "      <td>Salaried</td>\n",
       "      <td>East</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>56</td>\n",
       "      <td>244</td>\n",
       "      <td>19000</td>\n",
       "      <td>700</td>\n",
       "      <td>1620</td>\n",
       "      <td>3</td>\n",
       "      <td>Female</td>\n",
       "      <td>No</td>\n",
       "      <td>Home</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>West</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>28</td>\n",
       "      <td>218</td>\n",
       "      <td>81400</td>\n",
       "      <td>26620</td>\n",
       "      <td>600</td>\n",
       "      <td>3</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Apt</td>\n",
       "      <td>Salaried</td>\n",
       "      <td>West</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        age  weight  income  car_value  debt  mall_trips  gender alone  dwell  \\\n",
       "person                                                                          \n",
       "1        48     175   65500       2190  3510           7    Male    No   Home   \n",
       "2        33     202   29100       2110   740           4  Female    No  Condo   \n",
       "3        51     188   32200       5140   910           1    Male    No  Condo   \n",
       "4        56     244   19000        700  1620           3  Female    No   Home   \n",
       "5        28     218   81400      26620   600           3    Male    No    Apt   \n",
       "\n",
       "        pay_type  nbhd tried  \n",
       "person                        \n",
       "1         Hourly  East    No  \n",
       "2         Hourly  East   Yes  \n",
       "3       Salaried  East    No  \n",
       "4         Hourly  West    No  \n",
       "5       Salaried  West   Yes  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_lasagna = pd.read_csv(dataurl+'lasagna.csv', header=0, index_col='person')\n",
    "df_lasagna.head()"
   ]
  },
  {
   "attachments": {},
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For the Naive Bayes method, numeric predictors must be binned, i.e., made categorical. For this example, each numeric variable has been binned by its quartiles, shown below."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>weight</th>\n",
       "      <th>income</th>\n",
       "      <th>car_value</th>\n",
       "      <th>debt</th>\n",
       "      <th>mall_trips</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0.00</th>\n",
       "      <td>22.0</td>\n",
       "      <td>142.0</td>\n",
       "      <td>2600.0</td>\n",
       "      <td>130.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0.25</th>\n",
       "      <td>31.0</td>\n",
       "      <td>174.0</td>\n",
       "      <td>24475.0</td>\n",
       "      <td>2110.0</td>\n",
       "      <td>560.0</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0.50</th>\n",
       "      <td>37.5</td>\n",
       "      <td>190.0</td>\n",
       "      <td>39950.0</td>\n",
       "      <td>4175.0</td>\n",
       "      <td>1020.0</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0.75</th>\n",
       "      <td>46.0</td>\n",
       "      <td>210.0</td>\n",
       "      <td>58225.0</td>\n",
       "      <td>7717.5</td>\n",
       "      <td>1972.5</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1.00</th>\n",
       "      <td>64.0</td>\n",
       "      <td>258.0</td>\n",
       "      <td>190500.0</td>\n",
       "      <td>33870.0</td>\n",
       "      <td>8960.0</td>\n",
       "      <td>17.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       age  weight    income  car_value    debt  mall_trips\n",
       "0.00  22.0   142.0    2600.0      130.0     0.0         0.0\n",
       "0.25  31.0   174.0   24475.0     2110.0   560.0         3.0\n",
       "0.50  37.5   190.0   39950.0     4175.0  1020.0         4.0\n",
       "0.75  46.0   210.0   58225.0     7717.5  1972.5         7.0\n",
       "1.00  64.0   258.0  190500.0    33870.0  8960.0        17.0"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_quantile = df_lasagna.quantile([0, .25, .5, .75, 1])\n",
    "df_quantile"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>weight</th>\n",
       "      <th>income</th>\n",
       "      <th>car_value</th>\n",
       "      <th>debt</th>\n",
       "      <th>mall_trips</th>\n",
       "      <th>gender</th>\n",
       "      <th>alone</th>\n",
       "      <th>dwell</th>\n",
       "      <th>pay_type</th>\n",
       "      <th>nbhd</th>\n",
       "      <th>tried</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>person</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Home</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>East</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Female</td>\n",
       "      <td>No</td>\n",
       "      <td>Condo</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>East</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Condo</td>\n",
       "      <td>Salaried</td>\n",
       "      <td>East</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>Female</td>\n",
       "      <td>No</td>\n",
       "      <td>Home</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>West</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Apt</td>\n",
       "      <td>Salaried</td>\n",
       "      <td>West</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        age  weight  income  car_value  debt  mall_trips  gender alone  dwell  \\\n",
       "person                                                                          \n",
       "1         3       1       3          1     3           3    Male    No   Home   \n",
       "2         1       2       1          1     1           2  Female    No  Condo   \n",
       "3         3       1       1          2     1           0    Male    No  Condo   \n",
       "4         3       3       0          0     2           1  Female    No   Home   \n",
       "5         0       3       3          3     1           1    Male    No    Apt   \n",
       "\n",
       "        pay_type  nbhd tried  \n",
       "person                        \n",
       "1         Hourly  East    No  \n",
       "2         Hourly  East   Yes  \n",
       "3       Salaried  East    No  \n",
       "4         Hourly  West    No  \n",
       "5       Salaried  West   Yes  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "for col in df_lasagna.columns:\n",
    "    if df_lasagna[col].dtypes == 'int64': \n",
    "        df_lasagna[col] = pd.cut(df_lasagna[col], bins=round(df_quantile[col])-[1,1,1,1,0], labels=False)\n",
    "df_lasagna.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We partition data into training and testing datasets."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_lasagna_train = df_lasagna.iloc[:700]\n",
    "df_lasagna_test = df_lasagna.iloc[700:]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We fit a frequency count based on the training data, which provides the probability of a feature given an individual's class. For example, \n",
    "\n",
    "- ('No', 'Home'): 0.468 shows that, if a customer did not try the lasagna product, the probability of his/her dwell type being Home is 0.468, i.e.,\n",
    "\n",
    "\\begin{align}\n",
    "p(\\text{Home}|\\text{No}) = 0.468 \\nonumber\n",
    "\\end{align}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "fcf89b8c51994d8dbba43ed62f38d6a7",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "interactive(children=(Dropdown(description='column:', index=8, options=('age', 'weight', 'income', 'car_value'…"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "def frequency_count(col, normalize):\n",
    "    return dict(df_lasagna_train.groupby('tried')[col].value_counts(normalize=normalize))\n",
    "\n",
    "interact(frequency_count,\n",
    "         col=widgets.Dropdown(options=df_lasagna_train.columns, value='dwell', description='column:',disabled=False),\n",
    "         normalize=widgets.Checkbox(value=True, description='normalize',disabled=False)\n",
    "        );"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The we calculate $p(\\text{feature}|\\text{No})$ and $p(\\text{feature}|\\text{Yes})$ for each customer. For example, for the first person\n",
    "\n",
    "\\begin{align}\n",
    "p(\\text{features of person 1}|\\text{No}) = p(\\text{age}=3|\\text{No}) \\times p(\\text{weight}=1|\\text{No}) \\times \\cdots \\times p(\\text{nbhd $=$ East}|\\text{No}) \\nonumber\n",
    "\\end{align}\n",
    "\n",
    "and\n",
    "\n",
    "\\begin{align}\n",
    "p(\\text{features of person 1}|\\text{Yes}) = p(\\text{age}=3|\\text{Yes}) \\times p(\\text{weight}=1|\\text{Yes}) \\times \\cdots \\times p(\\text{nbhd $=$ East}|\\text{Yes}) \\nonumber\n",
    "\\end{align}\n",
    "\n",
    "Here we assume all features are independent so that simple multiplication can be applied. The probability $p(\\text{features of person 1}|\\text{No})$ can be interpret as\n",
    "\n",
    "- if a person did not want to try the lasagna product, s/he has probability $p(\\text{features of person 1}|\\text{No})$ being person 1.\n",
    "\n",
    "Therefore, our prediction is as simple as follows:\n",
    "\n",
    "- If $p(\\text{features of person 1}|\\text{No}) > p(\\text{features of person 1}|\\text{Yes})$ then we prediction the person will **not** try the production\n",
    "\n",
    "- Otherwise, we prediction the person will try the production"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>age</th>\n",
       "      <th>weight</th>\n",
       "      <th>income</th>\n",
       "      <th>car_value</th>\n",
       "      <th>debt</th>\n",
       "      <th>mall_trips</th>\n",
       "      <th>gender</th>\n",
       "      <th>alone</th>\n",
       "      <th>dwell</th>\n",
       "      <th>pay_type</th>\n",
       "      <th>nbhd</th>\n",
       "      <th>tried</th>\n",
       "      <th>prediction</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>person</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Home</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>East</td>\n",
       "      <td>No</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>Female</td>\n",
       "      <td>No</td>\n",
       "      <td>Condo</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>East</td>\n",
       "      <td>Yes</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Condo</td>\n",
       "      <td>Salaried</td>\n",
       "      <td>East</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>Female</td>\n",
       "      <td>No</td>\n",
       "      <td>Home</td>\n",
       "      <td>Hourly</td>\n",
       "      <td>West</td>\n",
       "      <td>No</td>\n",
       "      <td>No</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Male</td>\n",
       "      <td>No</td>\n",
       "      <td>Apt</td>\n",
       "      <td>Salaried</td>\n",
       "      <td>West</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        age  weight  income  car_value  debt  mall_trips  gender alone  dwell  \\\n",
       "person                                                                          \n",
       "1         3       1       3          1     3           3    Male    No   Home   \n",
       "2         1       2       1          1     1           2  Female    No  Condo   \n",
       "3         3       1       1          2     1           0    Male    No  Condo   \n",
       "4         3       3       0          0     2           1  Female    No   Home   \n",
       "5         0       3       3          3     1           1    Male    No    Apt   \n",
       "\n",
       "        pay_type  nbhd tried prediction  \n",
       "person                                   \n",
       "1         Hourly  East    No        Yes  \n",
       "2         Hourly  East   Yes         No  \n",
       "3       Salaried  East    No         No  \n",
       "4         Hourly  West    No         No  \n",
       "5       Salaried  West   Yes        Yes  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def predict(df):\n",
    "    df['prediction'] = ['No' \n",
    "        if np.prod([frequency_count(col, True)[('No',df.iloc[row][col])]\n",
    "                   for col in df.columns if col not in ['tried','prediction']]) > \\\n",
    "           np.prod([frequency_count(col, True)[('Yes',df.iloc[row][col])]\n",
    "                   for col in df.columns if col not in ['tried','prediction']])\\\n",
    "        else 'Yes'\n",
    "                   for row in range(df.shape[0])]\n",
    "\n",
    "predict(df_lasagna_train)\n",
    "df_lasagna_train.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The classification matrix of training data is"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>tried</th>\n",
       "      <th>No</th>\n",
       "      <th>Yes</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>prediction</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>No</th>\n",
       "      <td>250</td>\n",
       "      <td>81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Yes</th>\n",
       "      <td>49</td>\n",
       "      <td>320</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "tried        No  Yes\n",
       "prediction          \n",
       "No          250   81\n",
       "Yes          49  320"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_lasagna_train.groupby(['prediction','tried']).size().unstack(level=1, fill_value=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The frequency count can be used in testing data and the classification matrix is"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>tried</th>\n",
       "      <th>No</th>\n",
       "      <th>Yes</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>prediction</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>No</th>\n",
       "      <td>56</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Yes</th>\n",
       "      <td>6</td>\n",
       "      <td>73</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "tried       No  Yes\n",
       "prediction         \n",
       "No          56   21\n",
       "Yes          6   73"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predict(df_lasagna_test)\n",
    "df_lasagna_test.groupby(['prediction','tried']).size().unstack(level=1, fill_value=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Multinomial Naive Bayes\n",
    "\n",
    "The Gaussian assumption just described is by no means the only simple assumption that could be used to specify the generative distribution for each label.\n",
    "Another useful example is multinomial naive Bayes, where the features are assumed to be generated from a simple multinomial distribution.\n",
    "The multinomial distribution describes the probability of observing counts among a number of categories, and thus multinomial naive Bayes is most appropriate for features that represent counts or count rates.\n",
    "\n",
    "The idea is precisely the same as before, except that instead of modeling the data distribution with the best-fit Gaussian, we model the data distribuiton with a best-fit multinomial distribution."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Example: Classifying Text\n",
    "\n",
    "One place where multinomial naive Bayes is often used is in text classification, where the features are related to word counts or frequencies within the documents to be classified.\n",
    "\n",
    "here we will use the sparse word count features from the 20 Newsgroups corpus to show how we might classify these short documents into categories.\n",
    "\n",
    "Let's download the data and take a look at the target names:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Downloading 20news dataset. This may take a few minutes.\n",
      "Downloading dataset from https://ndownloader.figshare.com/files/5975967 (14 MB)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "['alt.atheism',\n",
       " 'comp.graphics',\n",
       " 'comp.os.ms-windows.misc',\n",
       " 'comp.sys.ibm.pc.hardware',\n",
       " 'comp.sys.mac.hardware',\n",
       " 'comp.windows.x',\n",
       " 'misc.forsale',\n",
       " 'rec.autos',\n",
       " 'rec.motorcycles',\n",
       " 'rec.sport.baseball',\n",
       " 'rec.sport.hockey',\n",
       " 'sci.crypt',\n",
       " 'sci.electronics',\n",
       " 'sci.med',\n",
       " 'sci.space',\n",
       " 'soc.religion.christian',\n",
       " 'talk.politics.guns',\n",
       " 'talk.politics.mideast',\n",
       " 'talk.politics.misc',\n",
       " 'talk.religion.misc']"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.datasets import fetch_20newsgroups\n",
    "\n",
    "data = fetch_20newsgroups()\n",
    "data.target_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "categories = ['talk.religion.misc', 'soc.religion.christian',\n",
    "              'sci.space', 'comp.graphics']\n",
    "train = fetch_20newsgroups(subset='train', categories=categories)\n",
    "test = fetch_20newsgroups(subset='test', categories=categories)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns; sns.set()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.feature_extraction.text import TfidfVectorizer\n",
    "from sklearn.naive_bayes import MultinomialNB\n",
    "from sklearn.pipeline import make_pipeline\n",
    "\n",
    "model = make_pipeline(TfidfVectorizer(), MultinomialNB())\n",
    "model.fit(train.data, train.target)\n",
    "labels = model.predict(test.data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics import confusion_matrix\n",
    "mat = confusion_matrix(test.target, labels)\n",
    "sns.heatmap(mat.T, square=True, annot=True, fmt='d', cbar=False,\n",
    "            xticklabels=train.target_names, yticklabels=train.target_names)\n",
    "plt.xlabel('true label')\n",
    "plt.ylabel('predicted label');"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "def predict_category(s, train=train, model=model):\n",
    "    pred = model.predict([s])\n",
    "    return train.target_names[pred[0]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'soc.religion.christian'"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predict_category('discussing islam vs atheism')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'comp.graphics'"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predict_category('determining the screen resolution')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'sci.space'"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "predict_category('that movie was a bomb')"
   ]
  }
 ],
 "metadata": {
  "hide_input": false,
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  },
  "widgets": {
   "application/vnd.jupyter.widget-state+json": {
    "state": {
     "030c487009d1410d8ced064dd107565d": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_3b8552f9a2824a95bdb5ea78b829ee67",
       "outputs": [
        {
         "data": {
          "text/plain": "{('No', 'Home'): 0.4682274247491639,\n ('No', 'Condo'): 0.3010033444816054,\n ('No', 'Apt'): 0.23076923076923078,\n ('Yes', 'Home'): 0.4463840399002494,\n ('Yes', 'Apt'): 0.2817955112219451,\n ('Yes', 'Condo'): 0.2718204488778055}"
         },
         "metadata": {},
         "output_type": "display_data"
        }
       ]
      }
     },
     "088e80d27aa94dc5845bae94e1ba505c": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "Column:",
       "index": 10,
       "layout": "IPY_MODEL_c1fdc4bd8e414f5eba6b721dd735eaec",
       "style": "IPY_MODEL_78ec677b4ffd43999ab44d7173b2b98d"
      }
     },
     "088eef9a400947bb8f1bd62367c8414a": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "09372641f0eb4e51a972acf2a2edd5ab": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "column:",
       "index": 8,
       "layout": "IPY_MODEL_eb8e6a4e902944fb8ae7a8a8be64d533",
       "style": "IPY_MODEL_c895cab4be9c4e2d9b4bd8677f48eb8f"
      }
     },
     "0e5e5d3db5a94ca5be9f31b97541103e": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_5d70dac643644120a45f9e9b7d1c65e1",
       "outputs": [
        {
         "data": {
          "text/plain": "{('No', 0): 114,\n ('No', 1): 84,\n ('No', 2): 60,\n ('No', 3): 41,\n ('Yes', 3): 133,\n ('Yes', 2): 118,\n ('Yes', 1): 96,\n ('Yes', 0): 54}"
         },
         "metadata": {},
         "output_type": "display_data"
        }
       ]
      }
     },
     "11f30440d26e49aa897d4ca9450b4b1c": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "144c023c6db448e4900de9b761cf3d72": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "270809a559ab4649ab560cb5df432a5a": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "2996961fca8f4a8ab512f184a1a4aa27": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_3efeb61257ac496282bd1937d7bb8967",
        "IPY_MODEL_642d0764a4894e73900e4c3ab936de3d"
       ],
       "layout": "IPY_MODEL_ff11d81ca5094e0a9e39eaee11232930"
      }
     },
     "2a72908e9f86469381708572f49031f3": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "2d78545b9cac485eb3f5dd443add87f8": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "39b23b35de654b61b0e337f7143f1994": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "CheckboxModel",
      "state": {
       "description": "normalize",
       "disabled": false,
       "layout": "IPY_MODEL_b3c811a701d54294bc88364048ce1c35",
       "style": "IPY_MODEL_88f062c326c64eaea7096b150784fc98",
       "value": true
      }
     },
     "3b8552f9a2824a95bdb5ea78b829ee67": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "3efeb61257ac496282bd1937d7bb8967": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "Column:",
       "index": 0,
       "layout": "IPY_MODEL_cd750e09a5164090945128e2ca4a7dc5",
       "style": "IPY_MODEL_eb27b3528d114714947314686216cd37"
      }
     },
     "4a6b7e7cb6454ac8b7c9e2d7f91a5822": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "5a74a4e44b3e4dc7aefdc49c2353bab8": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_09372641f0eb4e51a972acf2a2edd5ab",
        "IPY_MODEL_b21f64157ea84696b46fb2d5b8b7194a",
        "IPY_MODEL_e8e75fbeecf64b1ea52b5042160f7512"
       ],
       "layout": "IPY_MODEL_f6055c98e8d94d229f27f3b524db9478"
      }
     },
     "5d70dac643644120a45f9e9b7d1c65e1": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "5ec1d2f33c8a4188b69629a028b84ff1": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_9431d8c583cf42308c2aabf9bc75dd6b",
        "IPY_MODEL_67d6b88db7f24e16965191027c13da78"
       ],
       "layout": "IPY_MODEL_72f1ecfe3218403792b0a794fa6c056a"
      }
     },
     "642d0764a4894e73900e4c3ab936de3d": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_6e618252456c4b19b326e7ce3c8c113b",
       "outputs": [
        {
         "ename": "TypeError",
         "evalue": "'dict' object is not callable",
         "output_type": "error",
         "traceback": [
          "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
          "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
          "\u001b[1;32m~\\AppData\\Local\\Continuum\\anaconda3\\envs\\bzan\\lib\\site-packages\\ipywidgets\\widgets\\interaction.py\u001b[0m in \u001b[0;36mupdate\u001b[1;34m(self, *args)\u001b[0m\n\u001b[0;32m    249\u001b[0m                     \u001b[0mvalue\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mwidget\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mget_interact_value\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    250\u001b[0m                     \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mwidget\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_kwarg\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mvalue\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 251\u001b[1;33m                 \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mresult\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mf\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m**\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    252\u001b[0m                 \u001b[0mshow_inline_matplotlib_plots\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    253\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mauto_display\u001b[0m \u001b[1;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mresult\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
          "\u001b[1;31mTypeError\u001b[0m: 'dict' object is not callable"
         ]
        }
       ]
      }
     },
     "67d6b88db7f24e16965191027c13da78": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_b4328f18e86e4d72a4068793c13ece74",
       "outputs": [
        {
         "ename": "TypeError",
         "evalue": "'dict' object is not callable",
         "output_type": "error",
         "traceback": [
          "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
          "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
          "\u001b[1;32m~\\AppData\\Local\\Continuum\\anaconda3\\envs\\bzan\\lib\\site-packages\\ipywidgets\\widgets\\interaction.py\u001b[0m in \u001b[0;36mupdate\u001b[1;34m(self, *args)\u001b[0m\n\u001b[0;32m    249\u001b[0m                     \u001b[0mvalue\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mwidget\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mget_interact_value\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    250\u001b[0m                     \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m[\u001b[0m\u001b[0mwidget\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_kwarg\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mvalue\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 251\u001b[1;33m                 \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mresult\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mf\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m**\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    252\u001b[0m                 \u001b[0mshow_inline_matplotlib_plots\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    253\u001b[0m                 \u001b[1;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mauto_display\u001b[0m \u001b[1;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mresult\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
          "\u001b[1;31mTypeError\u001b[0m: 'dict' object is not callable"
         ]
        }
       ]
      }
     },
     "699e5a8612e0429b8e7efe5c65e303ee": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "6e618252456c4b19b326e7ce3c8c113b": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "72f1ecfe3218403792b0a794fa6c056a": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "76247d988f024141ad8c6b4c4f2acae2": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_4a6b7e7cb6454ac8b7c9e2d7f91a5822",
       "outputs": [
        {
         "data": {
          "text/plain": "{('No', 'No'): 271, ('No', 'Yes'): 28, ('Yes', 'No'): 306, ('Yes', 'Yes'): 95}"
         },
         "metadata": {},
         "output_type": "display_data"
        }
       ]
      }
     },
     "764e1914c53d40f3a26c342600141489": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_ed1b5a26f6f243daa0246888d8869c1c",
        "IPY_MODEL_76247d988f024141ad8c6b4c4f2acae2"
       ],
       "layout": "IPY_MODEL_270809a559ab4649ab560cb5df432a5a"
      }
     },
     "78ec677b4ffd43999ab44d7173b2b98d": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "7b411561029345079a41649012effcb0": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "Column:",
       "index": 0,
       "layout": "IPY_MODEL_2d78545b9cac485eb3f5dd443add87f8",
       "style": "IPY_MODEL_d78cdb09f41a43758b95b09831cd9835"
      }
     },
     "7d4de20a63604446acd409ff62f1c238": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_088e80d27aa94dc5845bae94e1ba505c",
        "IPY_MODEL_de09e4d8e77a4f3bad53753e5d0a7cfd"
       ],
       "layout": "IPY_MODEL_b87eebbeb0c04c54af3cedca133b8870"
      }
     },
     "8291685d395749cb9a6d3759d17a6c77": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "88f062c326c64eaea7096b150784fc98": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "8fc99cc858434a259e2fec8ea0cea8b7": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "9431d8c583cf42308c2aabf9bc75dd6b": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "Column:",
       "index": 0,
       "layout": "IPY_MODEL_8291685d395749cb9a6d3759d17a6c77",
       "style": "IPY_MODEL_088eef9a400947bb8f1bd62367c8414a"
      }
     },
     "aeba3057a6b24107831fd5b470a04517": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "b21f64157ea84696b46fb2d5b8b7194a": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "CheckboxModel",
      "state": {
       "description": "normalize",
       "disabled": false,
       "layout": "IPY_MODEL_fa0058d26d0d4e31a42909bc3bb43623",
       "style": "IPY_MODEL_144c023c6db448e4900de9b761cf3d72",
       "value": false
      }
     },
     "b3c811a701d54294bc88364048ce1c35": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "b3d9f949872b402c85e0fce3675fe20e": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "b4328f18e86e4d72a4068793c13ece74": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "b87eebbeb0c04c54af3cedca133b8870": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "bf8a81c9928b4799ae11b36481639f05": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "c1fdc4bd8e414f5eba6b721dd735eaec": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "c895cab4be9c4e2d9b4bd8677f48eb8f": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "cc1cf31782fb40258841bb7c775c4fda": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "cd750e09a5164090945128e2ca4a7dc5": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "d78cdb09f41a43758b95b09831cd9835": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "d8ca7b7c246a4308ad76a66c40217169": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_f77f421297434875804ee8629253445e",
        "IPY_MODEL_0e5e5d3db5a94ca5be9f31b97541103e"
       ],
       "layout": "IPY_MODEL_bf8a81c9928b4799ae11b36481639f05"
      }
     },
     "de09e4d8e77a4f3bad53753e5d0a7cfd": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_b3d9f949872b402c85e0fce3675fe20e",
       "outputs": [
        {
         "data": {
          "text/plain": "{('No', 'East'): 159,\n ('No', 'South'): 76,\n ('No', 'West'): 64,\n ('Yes', 'West'): 239,\n ('Yes', 'South'): 86,\n ('Yes', 'East'): 76}"
         },
         "metadata": {},
         "output_type": "display_data"
        }
       ]
      }
     },
     "e669e836fea040c6936a349c9c1b0cde": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried"
       ],
       "description": "column:",
       "index": 8,
       "layout": "IPY_MODEL_699e5a8612e0429b8e7efe5c65e303ee",
       "style": "IPY_MODEL_cc1cf31782fb40258841bb7c775c4fda"
      }
     },
     "e8e75fbeecf64b1ea52b5042160f7512": {
      "model_module": "@jupyter-widgets/output",
      "model_module_version": "1.0.0",
      "model_name": "OutputModel",
      "state": {
       "layout": "IPY_MODEL_11f30440d26e49aa897d4ca9450b4b1c",
       "outputs": [
        {
         "data": {
          "text/plain": "{('No', 'Home'): 140,\n ('No', 'Condo'): 90,\n ('No', 'Apt'): 69,\n ('Yes', 'Home'): 179,\n ('Yes', 'Apt'): 113,\n ('Yes', 'Condo'): 109}"
         },
         "metadata": {},
         "output_type": "display_data"
        }
       ]
      }
     },
     "e933b13a16aa47adaf3913ff73c750d7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "eb27b3528d114714947314686216cd37": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "eb8e6a4e902944fb8ae7a8a8be64d533": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "ed1b5a26f6f243daa0246888d8869c1c": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "Column:",
       "index": 7,
       "layout": "IPY_MODEL_aeba3057a6b24107831fd5b470a04517",
       "style": "IPY_MODEL_e933b13a16aa47adaf3913ff73c750d7"
      }
     },
     "f6055c98e8d94d229f27f3b524db9478": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "f6605a5a327b495eac0d85a679f1f961": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DescriptionStyleModel",
      "state": {
       "description_width": ""
      }
     },
     "f77f421297434875804ee8629253445e": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "DropdownModel",
      "state": {
       "_options_labels": [
        "age",
        "weight",
        "income",
        "car_value",
        "debt",
        "mall_trips",
        "gender",
        "alone",
        "dwell",
        "pay_type",
        "nbhd",
        "tried",
        "prediction"
       ],
       "description": "Column:",
       "index": 4,
       "layout": "IPY_MODEL_2a72908e9f86469381708572f49031f3",
       "style": "IPY_MODEL_f6605a5a327b495eac0d85a679f1f961"
      }
     },
     "fa0058d26d0d4e31a42909bc3bb43623": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     },
     "fcf89b8c51994d8dbba43ed62f38d6a7": {
      "model_module": "@jupyter-widgets/controls",
      "model_module_version": "1.4.0",
      "model_name": "VBoxModel",
      "state": {
       "_dom_classes": [
        "widget-interact"
       ],
       "children": [
        "IPY_MODEL_e669e836fea040c6936a349c9c1b0cde",
        "IPY_MODEL_39b23b35de654b61b0e337f7143f1994",
        "IPY_MODEL_030c487009d1410d8ced064dd107565d"
       ],
       "layout": "IPY_MODEL_8fc99cc858434a259e2fec8ea0cea8b7"
      }
     },
     "ff11d81ca5094e0a9e39eaee11232930": {
      "model_module": "@jupyter-widgets/base",
      "model_module_version": "1.1.0",
      "model_name": "LayoutModel",
      "state": {}
     }
    },
    "version_major": 2,
    "version_minor": 0
   }
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
